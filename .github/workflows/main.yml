name: update-api-docs
run-name: ${{ github.actor }} updated API docs
on: [push]
jobs:
  publish-api-spec:
    runs-on: ubuntu-latest
    permissions:
     contents: write
     pull-requests: write
     
    steps:
    # This step checks out a copy of your repository.
    - name: Get repo
      uses: actions/checkout@v4
      env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}   

    - name: Run publish.sh to generate index.html
      run: bash publish.sh 
      env:
        DIR_GHP: "gh-pages"
        OPENAPI_FILE: "opdio.yml"
        CNAME: "opdio.scales.cloud"
        
    - name: openapi-lint 
      uses: mhiew/redoc-lint-github-action@v3
      with:
        args: 'opdio.yml'

    - name: redoc-cli test
      uses: seeebiii/redoc-cli-github-action@v10
      with:
        args: 'opdio.yml'


